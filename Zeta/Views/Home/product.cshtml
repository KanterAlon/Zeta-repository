@{
    var productData = ViewBag.ProductData as JObject;
    var errorMessage = ViewBag.ErrorMessage as string;
    var productName = ViewBag.ProductName as string;
    var positivePoints = ViewBag.PositivePoints as List<string>;
    var negativePoints = ViewBag.NegativePoints as List<string>;
}

<h1 class="product-title">@productName</h1>

@if (!string.IsNullOrEmpty(errorMessage))
{
    <div class="error-message">
        <p>@errorMessage</p>
    </div>
}
else if (productData != null && productData.HasValues)
{
    <div class="product-section">
        <div class="product-inner">
            <div class="product-details-container">
                <div class="product-image-rating">
                    <div class="product-image-wrapper">
                        @if (!string.IsNullOrEmpty(productData["image_url"]?.ToString()))
                        {
                            <img src="@productData["image_url"].ToString()" 
                                 alt="@productName"
                                 class="product-image-new" />
                        }
                        else
                        {
                            <img src="/img/lays-classic.svg" 
                                 alt="Imagen no disponible"
                                 class="product-image-new" />
                        }
                        <div class="product-rating">
                            <span class="rating-circle rating-red"></span>
                            <h3 class="rating-text">
                                Calidad: @(productData["nutrition_grades_tags"]?.FirstOrDefault()?.ToString()?.ToUpper() ?? "Sin calificación")
                            </h3>
                        </div>
                    </div>
                </div>
                <div class="product-nutrition-info">
                    <div class="nutrition-info-item">
                        <img src="/img/icon_protein.svg" alt="Proteínas" class="nutrition-icon" />
                        <span>Proteínas: @(productData["nutriments"]?["proteins_100g"] ?? "No disponible") g</span>
                    </div>
                    <div class="nutrition-info-item">
                        <img src="/img/icon_scales.svg" alt="Carbohidratos" class="nutrition-icon" />
                        <span>Carbohidratos: @(productData["nutriments"]?["carbohydrates_100g"] ?? "No disponible") g</span>
                    </div>
                    <div class="nutrition-info-item">
                        <img src="/img/icon_tick.svg" alt="Grasas" class="nutrition-icon" />
                        <span>Grasas: @(productData["nutriments"]?["fat_100g"] ?? "No disponible") g</span>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="nutrition-evaluation">
        <h2>Evaluación Nutricional</h2>

        <h3>Aspectos Positivos</h3>
        @if (positivePoints != null && positivePoints.Count > 0)
        {
            foreach (var point in positivePoints)
            {
                <div class="nutrition-item positive">
                    <p>@point</p>
                </div>
            }
        }
        else
        {
            <p>No hay aspectos positivos destacados.</p>
        }

        <h3>Aspectos Negativos</h3>
        @if (negativePoints != null && negativePoints.Count > 0)
        {
            foreach (var point in negativePoints)
            {
                <div class="nutrition-item negative">
                    <p>@point</p>
                </div>
            }
        }
        else
        {
            <p>No hay aspectos negativos destacados.</p>
        }
    </div>
}
else
{
    <div class="no-data-message">
        <p>No se encontró información para el producto buscado: "<strong>@productName</strong>"</p>
    </div>
}