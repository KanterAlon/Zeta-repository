@{
    ViewData["HideHeader"] = true;
    var patologias = ViewBag.Patologias as List<Patologias>;
    var actividades = ViewBag.Actividades as List<Actividades>; // Lista de actividades físicas
}

 <!-- LOGIN SECTION -->
    <section id="login-section" class="login-container">
        <div class="login-content">
            <button class="back-button" onclick="window.location.href='/Home/'">
                <img src="~/img/icon_back.svg" alt="Back">
            </button>
            <div class="illustration">
                <img src="~/img/img_login.svg" alt="Person holding apple illustration" />
            </div>
            <div class="welcome-message">
                <h1 class="welcome-heading">Te damos la bienvenida a la comunidad Zeta</h1>
                <form asp-action="LoginValidation" method="post" class="login-form">
                    <div class="inputs-group">
                        <div class="input-group">
                            <input type="email" name="email" placeholder="Correo electrónico" required />
                        </div>
                        <div class="input-group">
                            <input type="password" name="password" placeholder="Contraseña" required />
                        </div>
                        <div class="forgot-password">
                            <a href="/Account/ForgotPassword">
                                <span class="small-text">¿Has olvidado tu contraseña?</span>
                            </a>
                        </div>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn-login">Iniciar sesión</button>
                        <button type="button" class="btn-create-account" onclick="navigateTo('ca1-section', 'login-section')">
                            Crear cuenta
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

  <form id="create-account-form" method="POST" action="/Home/CreateAccount">
    <!-- CA1 SECTION -->
    <section id="ca1-section" class="ca1-container">
        <button class="back-button" onclick="navigateTo('login-section', 'ca1-section')" type="button">
            <img src="~/img/icon_back.svg" alt="Back">
        </button>
        <div class="ca1-content">
            <div class="ca1-text">
                <h1 class="ca1-heading">Creá tu cuenta</h1>
                <h3 class="ca1-subheading">Ingresá tu email y contraseña</h3>
            </div>
            <div class="ca1-inputs-grid">
                <div class="ca1-input-group">
                    <input type="email" id="email" name="email" placeholder="Correo Electrónico" required />
                </div>
                <div class="ca1-input-group">
                    <input type="password" id="password" name="password" placeholder="Contraseña" required minlength="6" />
                </div>
            </div>
            <button type="button" class="ca1-btn-next" onclick="validateAndNavigate('ca2-section', 'ca1-section')">Siguiente</button>
        </div>
    </section>

    <!-- CA2 SECTION -->
    <section id="ca2-section" class="ca1-container" style="display: none;">
        <button class="back-button" onclick="navigateTo('ca1-section', 'ca2-section')" type="button">
            <img src="~/img/icon_back.svg" alt="Back">
        </button>
        <div class="ca1-content">
            <div class="ca1-text">
                <h1 class="ca1-heading">Creá tu cuenta</h1>
                <h3 class="ca1-subheading">Ingresa tus datos</h3>
            </div>
            <div class="ca1-inputs-grid">
                <div class="ca1-input-group">
                    <input type="text" id="nombre" name="nombre" placeholder="Nombre" required />
                </div>
                <div class="ca1-input-group">
                    <input type="text" id="apellido" name="apellido" placeholder="Apellido" required />
                </div>
                <div class="ca1-input-group">
                    <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" placeholder="Fecha de Nacimiento" required />
                </div>
                <div class="ca1-input-group">
                    <select name="genero" id="genero" required>
                        <option value="" selected>Selecciona tu género</option>
                        <option value="1">Masculino</option>
                        <option value="2">Femenino</option>
                        <option value="3">Otro</option>
                    </select>
                </div>
                <div class="ca1-input-group">
                    <input type="text" id="altura" name="altura" placeholder="Altura en cm" required pattern="\d+" />
                </div>
                <div class="ca1-input-group">
                    <input type="text" id="peso" name="peso" placeholder="Peso en kg" required pattern="\d+" />
                </div>
            </div>
            <button type="submit" class="ca1-btn-next">Crear Cuenta</button>
        </div>
    </section>
</form>



    <!-- NUEVO CA3 SECTION (con Patologías y Actividades) -->
    <section id="ca3-section" class="ca1-container" style="display: none;">
        <button class="back-button" onclick="navigateTo('ca2-section', 'ca3-section')" type="button">
            <img src="~/img/icon_back.svg" alt="Back">
        </button>
        <div class="ca1-content">
            <div class="ca1-text">
                <h1 class="ca1-heading">Ingresa tu información de salud</h1>
                <h3 class="ca1-subheading">Selecciona tus patologías y actividades físicas</h3>
            </div>
            <div class="ca1-inputs-grid">
                <div class="ca1-input-group">
                    <select name="patologia" id="patologia" required>
                        <option value="" selected>Selecciona tu patología</option>
                        @if (patologias != null && patologias.Any())
                        {
                            foreach (var patologia in patologias)
                            {
                                <option value="@patologia.IdPatologia">@patologia.NombrePatologia</option>
                            }
                        }
                    </select>
                </div>
                <div class="ca1-input-group">
                    <input type="number" min="0" name="cantActividades" id="cantActividades" placeholder="Ingresa cuántos tipos de deportes/actividades físicas realizas en la cotidianidad" required onchange="generarInputsActividades()" />
                </div>
                <div id="actividades-container"></div>
            </div>
            <button type="submit" class="ca1-btn-next">Siguiente</button>
        </div>
    </section>
<script>
    function navigateTo(showId, hideId) {
        // Oculta la sección actual
        document.getElementById(hideId).style.display = "none";
        // Muestra la nueva sección
        document.getElementById(showId).style.display = "flex";
    }

    function validateAndNavigate(showId, currentSectionId) {
        // Validar los campos dentro de la sección actual antes de avanzar
        const currentSection = document.getElementById(currentSectionId);
        const inputs = currentSection.querySelectorAll("input, select");

        let isValid = true;

        inputs.forEach(input => {
            if (!input.checkValidity()) {
                isValid = false;
                input.reportValidity(); // Muestra el mensaje de error del campo inválido
            }
        });

        if (isValid) {
            navigateTo(showId, currentSectionId);
        }
    }

    function generarInputsActividades() {
        const cantidad = document.getElementById('cantActividades').value;
        const container = document.getElementById('actividades-container');

        // Limpiar el contenedor para evitar duplicaciones
        container.innerHTML = "";

        for (let i = 1; i <= cantidad; i++) {
            // Crear contenedor para el select de actividad
            const actividadGroup = document.createElement('div');
            actividadGroup.className = 'ca1-input-group';

            // Crear select para seleccionar la actividad
            const selectActividad = document.createElement('select');
            selectActividad.name = `actividad_${i}`;
            selectActividad.required = true;

            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.selected = true;
            defaultOption.textContent = `Selecciona la actividad física número ${i}`;
            selectActividad.appendChild(defaultOption);

            // Llenar las opciones de actividades desde ViewBag
            @if (actividades != null && actividades.Any())
            {
                foreach (var actividad in actividades)
                {
                    <text>
                    const option = document.createElement('option');
                    option.value = "@actividad.IdActividad";
                    option.textContent = "@actividad.NombreActividad";
                    selectActividad.appendChild(option);
                    </text>
                }
            }

            actividadGroup.appendChild(selectActividad);
            container.appendChild(actividadGroup);

            // Crear contenedor para el input de horas
            const horasGroup = document.createElement('div');
            horasGroup.className = 'ca1-input-group';

            // Crear input para ingresar las horas semanales de la actividad
            const inputHoras = document.createElement('input');
            inputHoras.type = 'number';
            inputHoras.min = '0';
            inputHoras.name = `horasActividad_${i}`;
            inputHoras.placeholder = `Ingresa cuántas horas por semana realizas la actividad ${i}`;
            inputHoras.required = true;

            horasGroup.appendChild(inputHoras);
            container.appendChild(horasGroup);
        }
    }
</script>
