@{
    ViewData["Title"] = "Home Page";
}

    <section class="page">

        <div class="inner">
                
            <div class="evaluation-content">
                <h1>EVALUÁ TU PRODUCTO</h1>
                <h3>Acá encontrarás toda la información nutricional 100% simplificada</h3>

                <div class="search-bar">
                    <form action="/home/product" method="get">
                        <button type="submit" class="search-button">
                            <img src="/img/icon_search.svg" alt="Search Icon" width="20" height="20">
                        </button>
                        <input type="text" id="search-input" name="query" placeholder="Ej: Fideos Matarazzo" class="search-input" autocomplete="off">
                    </form>

                    <div id="autocomplete-results" class="autocomplete-results">
                        <div id="loader" class="loader">
                            <img src="/img/loader.gif" alt="Cargando...">
                        </div>
                    </div>
                </div>
            </div>


            <div class="info-buttons">

                <div class="info-button">
                    <img src="/img/icon_food.svg" alt="Icono Comida">
                    <span>Ingresás que querés comer</span>
                </div>
                
                <div class="info-button">
                    <img src="/img/icon_order-completed.svg" alt="Icono Order Completed">
                    <span>Obtenés feedback nutricional rápido</span>
                </div>

                <div class="info-button">
                    <img src="/img/icon_healthy-eating.svg" alt="Icono Información">
                    <span>Te informás íntegramente con facilidad</span>
                </div>

                <div class="info-button">
                    <img src="/img/icon_scales.svg" alt="Icono Decisión">
                    <span>Te ayudamos a tomar una decisión</span>
                </div>

            </div>

    </div>

</section>

<section class="sec-nutrition-evaluation">

    <div class="nutrition-evaluation-inner">

        <div class="product-info">

            <div class="img-rating">
                <img src="/img/lays-classic.svg" alt="Lays Clasicas" class="product-image">

                <div class="rating">
                    <div class="circle red"></div>
                    <h3>Muy Malo</h3>
                </div>

                <div class="circle-shadow-img">
                
                </div>
            </div>
            
            <div class="nutrition-details">
                <div class="nutrition-detail">
                    <img src="/img/icon_fat.svg" alt="Alto en grasas">
                    <span>Alto en Grasas</span>
                </div>
                <div class="nutrition-detail">
                    <img src="/img/icon_calories.svg" alt="Alto en calorías">
                    <span>Alto en Calorías</span>
                </div>
                <div class="nutrition-detail">
                    <img src="/img/icon_protein.svg" alt="Bajas proteínas">
                    <span>Bajas Proteínas</span>
                </div>
            </div>

        </div>

        <div class="nutritional-info">
            <h2>Conocé cual es la calidad nutricional de tus comidas y bebidas</h2>
            <p>¿Sabés realmente lo que estás comprando? ¡Nosotros sí! Zeta escanea y analiza las etiquetas en un abrir y cerrar de ojos para que puedas saber de un vistazo qué productos son buenos para ti y cuáles debes evitar.
            </p>
        </div>

    </div>

</section>
<section class="sec-funcionalidades">
    <div class="funcionalidades-inner">
        <h2>Otras cosas que podés disfrutar de la plataforma Zeta</h2>
        <div class="cards-container">
            <div class="card-funcionalidad">
                <div class="contenedor-imagen-card-funcionalidad">
                    <img src="/img/imgCard1.png" alt="Comparador de alimentos y bebidas" />
                </div>
                <h3 class="titulo-card-funcionalidad">Comparador de alimentos y bebidas</h3>
                <p class="descripcion-card-funcionalidad">
                    Compara de manera visual y rápida el valor nutricional de alimentos y bebidas,
                    ayudándote a tomar decisiones más saludables sin complicaciones.
                </p>
                <a class="button-card" href="" target="_blank">Pruébalo Ahora</a>
            </div>
            <div class="card-funcionalidad">
                <div class="contenedor-imagen-card-funcionalidad">
                    <img src="/img/imgCard2.png" alt="Interactuá con usuarios de intereses similares" />
                </div>
                <h3 class="titulo-card-funcionalidad">Interactuá con usuarios de intereses similares</h3>
                <p class="descripcion-card-funcionalidad">
                    Conectate con personas que comparten tus metas de salud y bienestar. A partir de nuestra sección
                    de comunidad vas a poder compartir experiencias, consejos y lograr tus objetivos junto a una
                    comunidad de gente comprometida.
                </p>
                <a class="button-card" href="" target="_blank">Ir a comunidad</a>
            </div>
            <div class="card-funcionalidad">
                <div class="contenedor-imagen-card-funcionalidad">
                    <img src="/img/imgCard3.png" alt="Aprendé sobre diversos temas de nutrición" />
                </div>
                <h3 class="titulo-card-funcionalidad">Aprendé sobre diversos temas de nutrición</h3>
                <p class="descripcion-card-funcionalidad">
                    Explorá artículos creados por nuestro equipo de expertos en nutrición. Descubrí información
                    confiable y práctica para mejorar tu bienestar y adoptar hábitos más saludables.
                </p>
                <a class="button-card" href="" target="_blank">Ir al Blog</a>
            </div>
        </div>
    </div>
</section>


<section class="sec-advertisements-blog">
    <div class="advertisements-blog-inner">
        <h2>Últimos Posts de nuestra comunidad</h2>
        <div class="cards-container">
            @if (ViewData["LastThreePosts"] != null)
            {
                var lastThreePosts = (List<Posts>)ViewData["LastThreePosts"];
                foreach (var Posts in lastThreePosts)
                {
                    <div class="card-advertisement-blog">
                        <div class="arriba-card-blog">
                            <p class="fecha-card-blog">@Posts.fecha_creacion.ToString("MMMM dd").ToUpper()</p>
                            <h3 class="titulo-card-blog">@Posts.titulo_post</h3>
                            <p class="descripcion-card-blog">@Posts.contenido_post</p>
                        </div>
                        <div class="contenedor-imagen-card-blog">
                            <img src="@Posts.imagen_url" alt="Imagen del post">
                        </div>
                    </div>
                }
            }
        </div>
    </div>
</section>


<section class="contact-section">
    <div class="contact-inner">
        <div class="contact-image">
            <img src="/img/img_contact.svg" alt="Contacto">
        </div>
        <div class="contact-content">
            <h2 style="color: var(--primary-color);">¿Te quedó alguna inquietud?</h2>
            <h3>Escribinos que a la brevedad te contestamos.</h3>
            <a href="/home/contact" class="contact-button"><span style="color: var(--whiteback);">Ir a contacto</span></a>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('search-input');
    const autocompleteResults = document.getElementById('autocomplete-results');
    const loader = document.getElementById('loader');
    let timeoutId = null;

    searchInput.addEventListener('input', () => {
        const query = searchInput.value.trim();
        clearTimeout(timeoutId);

        if (query.length > 0) {
            autocompleteResults.style.display = 'block'; // Mostrar el contenedor
            loader.style.display = 'flex'; // Mostrar el loader

            // Limpiar resultados previos sin borrar el loader
            Array.from(autocompleteResults.children).forEach(child => {
                if (!child.classList.contains('loader')) {
                    child.remove();
                }
            });

            timeoutId = setTimeout(() => {
                fetchSuggestions(query);
            }, 500);
        } else {
            autocompleteResults.style.display = 'none'; // Ocultar el contenedor si no hay input
        }
    });

    autocompleteResults.addEventListener('click', (event) => {
        const selectedItem = event.target.closest('.autocomplete-item');
        if (selectedItem) {
            const selectedProduct = selectedItem.dataset.productName;
            searchInput.value = selectedProduct;

            // Redirigir directamente a la página de resultados
            window.location.href = `/home/product?query=${encodeURIComponent(selectedProduct)}`;
        }
    });

    function fetchSuggestions(query) {
        fetch(`/home/SearchProducts?query=${encodeURIComponent(query)}`)
            .then(response => response.json())
            .then(data => {
                // Limpiar resultados previos
                Array.from(autocompleteResults.children).forEach(child => {
                    if (!child.classList.contains('loader')) {
                        child.remove();
                    }
                });

                if (data.success && data.products.length > 0) {
                    loader.style.display = 'none'; // Ocultar el loader

                    data.products.forEach(product => {
                        const item = document.createElement('div');
                        item.classList.add('autocomplete-item');
                        item.dataset.productName = product.name;

                        item.innerHTML = `
                            <img src="${product.image}" alt="${product.name}" style="width:30px; height:30px; margin-right:10px;">
                            <span>${product.name}</span>
                        `;
                        autocompleteResults.appendChild(item);
                    });
                } else {
                    loader.style.display = 'none'; // Ocultar el loader si no hay resultados
                    const noResults = document.createElement('div');
                    noResults.classList.add('autocomplete-item');
                    noResults.textContent = 'No se encontraron resultados.';
                    autocompleteResults.appendChild(noResults);
                }
            })
            .catch(error => {
                console.error('Error fetching suggestions:', error);
                loader.style.display = 'none'; // Ocultar el loader si ocurre un error
                const errorItem = document.createElement('div');
                errorItem.classList.add('autocomplete-item');
                errorItem.textContent = 'Error al cargar resultados.';
                autocompleteResults.appendChild(errorItem);
            });
    }
});


</script>